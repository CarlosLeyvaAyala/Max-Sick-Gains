<!DOCTYPE html><html><head>
      <title>muscle-definition</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>
figcaption{
    text-align: center;
    font-size: smaller;
}

figure{
    text-align: center;
    margin: 0 auto 1em auto;
}

.vImg{
    height: 400px;
}

.hImg{
    width: 500px;
}
</style>
<h1 class="mume-header" id="muscle-definition">Muscle definition</h1>

<p>After many months of frustrating work trying to do this in <a href="https://github.com/CarlosLeyvaAyala/Sandow-Plus-Plus">Sandow Plus Plus</a>, it seems I finally managed to make vary muscle definition without varying weight.</p>
<p>This approach doesn&apos;t use NiOverride for texture overriding, since it&apos;s quite fickle in Skyrim SE and it does whatever the hell it feels like. <br>
I suspect this is a problem with the new optimizations to nif files that were made for SE, but I have no way to confirm this.</p>
<h2 class="mume-header" id="some-context-on-what-failed">Some context on what failed</h2>

<p>This will totally matters to you if you are trying to develop a mod that changes normal maps using NiOverride fo SSE.</p>
<p>You may inocently think that changing normal maps is as easy and simple as adding a normal map override to the body and be done (just as I thought when I was young and inocent), but no.<br>
For some reason, <strong>doing so applies the same normal texture on the hands as well</strong>, and if you want to unreliably deal with that you need to do all kind of hacks that randomly work whenever they feel like.</p>
<p>Go see my own <a href="https://github.com/CarlosLeyvaAyala/Sandow-Plus-Plus/tree/more-compatible-ripped">Sandow Plus Plus source code</a> to marvel at what a fucking mess is trying to (unsuccessfully) do that.</p>
<p>Hell, that seemingly inocent idea so sapped my will to work with NiOverride (and my sanity) that SPP is mostly abandonware nowadays.</p>
<figure>
<img class="vImg" src="img/pizza-hands.jpg">
<figcaption>I literally spent hundreds of hours and moths on not solving this issue, thank you very much for asking.</figcaption>
</figure>
<p>My primary method to deal with those pizza hands was to just add a hands overlay on the first overlay layer (<code>&quot;Hands [Ovl0]&quot;</code>). I deemed that a reasonable solution because what kind of freak uses hand overlays, anyway? :v</p>
<p>It seemed to worked alright, but <strong>if wanted that method to be compatible with other mods</strong> that add their own overrides, like Wet Function Redux, I needed to transfer changes made by them.<br>
And that was the beginning of the end.</p>
<p>For some reason, Skyrim (or NiOverride?) sometimes lost track of the skin color and I got miscolored hands, I added too much conditional code that tried to solve that, but the hand color problem sometimes triggered at random times (just to never go away on that playthrough) even if everything was supposed to be working as expected; variables had correct values, they were being correctly applied...<br>
That&apos;s were I just gave up.</p>
<p>You can see that whole ordeal <a href="https://github.com/CarlosLeyvaAyala/Sandow-Plus-Plus/blob/more-compatible-ripped/scripts/source/DM_SandowPP_TextureMngr.psc">here</a>.</p>
<h2 class="mume-header" id="the-new-method-that-actually-works">The new method that actually works</h2>

<p>It uses <code>BaseActor.SetSkin(some_naked_armor)</code> to put bodies with different muscle definitions on actors.</p>
<p>Quick technical background: in Skyrim, naked bodies are actually armors (yeah... like in Daedric or Iron Armor). When you are setting a skin (a naked body), you are setting an armor as the default body for an actor.</p>
<p>Armors use <strong>Armor Addons</strong> to select which race will use what appearance.<br>
For example, thanks to Armor Addons you could have a cowl (like the Shrouded one) that will use some model on humanoids and that will use some other completely different model on Argonians or Khajiit... hell you could even have dogs using that same cowl if you created a new Armor Addon for dogs.</p>
<p>Knowing this, we can deduce some things about the new method for making actors ripped:</p>
<ul>
<li>Doesn&apos;t need NiOverride skin/node overrides at all.</li>
<li>It&apos;s 100% compatible with any mod that applies its own overrides.</li>
<li>Needs armor records inside an <code>esp</code> file.</li>
</ul>
<p>In fact, the <code>esp</code> file needs a new armor record for each muscle definition type AND muscle definition level. This mod uses 3 types (plain, athletic and fat) with 6 different levels. That means, 18 different armors.</p>
<p>There are also 3 special armors that automatically select the aproppiate muscle definition level based on weight using Skin Texture Swap Lists (the method I used for <a href="https://www.nexusmods.com/skyrimspecialedition/mods/34632">Ripped Bodies</a>).<br>
Total armors used: 21.</p>
<figure>
<img class="vImg" src="img/armors.png">
<figcaption>Armors ending in 00 automatically change their muscle definition using a Swap List on their Armor Addons. Otherwise, they explicitly set that muscle definition level.</figcaption>
</figure>
<p>There are 3 big racial groups in vanilla races: Humanoids (Men and Mer), Khajiit and Argonians.<br>
Each one of those need:</p>
<ul>
<li>One Armor Addon for the torso.<br>
Armor Addons per racial group: 21.</li>
<li>Each Armor Addon needs a Texture Set for its muscle definition level. Multiply by 2 because there are only 2 genders.<br>
Texture Sets per race: 18&#xD7;2=36.</li>
<li>The 3 special armor addons that automatically swap textures based on weight need 1 formlist per gender.<br>
Formlists for the special armor for just one race: 3&#xD7;1&#xD7;2=18.</li>
</ul>
<p>Want to add a completely new racial group, like furries or something? Add all those records above to the esp and change many, many things in <a href="https://github.com/CarlosLeyvaAyala/Max-Sick-Gains-exe">Max Sick Gains.exe</a>.</p>
<figure>
<img class="vImg" src="img/yiff-in-hell.jpg">
<figcaption>Now you know why I&apos;m not enabling muscle definition for some types of non vanilla races.</figcaption>
</figure>
<p>Non vanilla races that kinda fit in the vanilla racial groups may need a minor patch for their respective Armor Addons. It should hopefully be just a matter of adding their race to them.</p>
<h1 class="mume-header" id="method-overview">Method overview</h1>

<p>Here&apos;s the overview of the method for changing normal maps on actors:</p>
<h2 class="mume-header" id="non-coding-steps">Non coding steps</h2>

<ol>
<li>Create zeroed-slider bodies in Bodyslide. This will prevent bodies from varying by weight.</li>
<li>For each muscle definition level, create a new naked armor with its respective armor addons in the CK.</li>
<li>Create your wanted muscle definition texture sets in the CK.</li>
<li>Create a formlist containing those texture sets.</li>
<li>Assign this formlist to the new armor addon.</li>
</ol>
<p>This will create a body that has many different muscle definition levels according to weight.</p>
<p>This is mostly the way <a href="https://www.nexusmods.com/skyrimspecialedition/mods/34632">SPP Ripped Bodies</a> work, but here we are making a new naked body with its own list for each type of muscle definition we want (only fat textures, only fit textures...).</p>
<h2 class="mume-header" id="papyrus-steps">Papyrus steps</h2>

<ol>
<li>Set <code>Actor</code> body shape using <code>NiOverride.SetMorphValue</code>. This will set the overall shape of the actor.</li>
<li>Assign your desired muscle definition by setting the actor skin to the new armor you created: <code>(npc.GetBaseObject() as ActorBase).SetSkin(custom_naked_armor)</code>.</li>
</ol>
<p>All previous steps decouple weight from appearance and body shape.</p>
<p>If you want to:</p>
<ul>
<li>Vary the appearance of the actor, as if changing weight: <code>NiOverride.SetMorphValue</code>.</li>
<li>Vary muscle definition using a la <a href="https://www.nexusmods.com/skyrimspecialedition/mods/34632">Ripped Bodies</a>: <code>SetNPCWeight(new_weight)</code>.</li>
<li>Switch to other kind of muscle definition: <code>BaseActor.SetSkin(other_naked_armor)</code></li>
</ul>
<h1 class="mume-header" id="wrapping-up">Wrapping up</h1>

<p>That&apos;s all there is to this mod.</p>
<p>Of course, the implementation of these ideas is an entirely different matter. <br>
There are many interpolations to make transitions smooth, managing variables, etc, but the general idea behind this mod is what you have seen in this page.</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>